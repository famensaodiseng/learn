
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>使用动画绘制一个圆</title>
	<style>
	canvas{
		border: 1px solid black;
	}
	</style>
</head>
<body>
	<canvas id = "cas" width="600" height="600"></canvas>
</body>
<script>
	var cas= document.getElementById('cas');
	var ctx=cas.getContext("2d");


	//圆弧
	function toAngle (radian){
		return radian *180 /Math.PI;
	}
	function toRadian (angle){
		return angle *Math.PI/180;
	}


	//绘制三等分饼形图
	var x = cas.width /2;
	var y = cas.height /2;
		r =100;


	var step =120;
		start = -90;
	//定义我们的颜色
	var colors = ['red','green','blue'];

	var txts = ['测试数据','abc','33%'];
	var x1,y1;//记录文字的坐标
	var distance = 30;//超出圆饼的距离，用于计算文字的坐标
	var textLine;//文本 的下划线
	var paddingX=20/3,paddingY=20/3;//来设置文本的移动
	ctx.font = '20px Consolas';
	//文字就和饼颜色一致
	//绘制扇形
	for (var i=0;i<3;i++){
		ctx.beginPath();
		ctx.fillStyle = colors[i];
		ctx.moveTo(x,y);
		ctx.arc(x,y,r,toRadian(start),toRadian(start+step));
		ctx.fill();
	//绘制文本
	ctx.beginPath();
	ctx.strokeStyle = colors[i];
	ctx.moveTo(x,y);

	x1 = x+(r+distance)*Math.cos(toRadian( start+step/2));
	y1 = y+(r+distance)*Math.sin(toRadian(start+step/2)) ;
	ctx.lineTo(x1,y1);

	//文字底下画一条横线
	//计算长度
	textLine = ctx.measureText(txts[i]).width+2;


	if (start +step/2<270&&start +step/2>90){
		textLine =-ctx.measureText(txts[i]).width;
	}
	ctx.lineTo(x1+textLine,y1);
	ctx.stroke(); 

	//写文字
	
	//判断
	if (start +step/2<270&&start +step/2>90){
		ctx.textAlign = "right";
		paddingX=-20/3;
	}
	ctx.fillText(txts[i],x1+paddingX,y1-paddingY);
	start +=step;
	}
</script>
</html>


//ctx.measureText(文本) 获取当前文本的对象