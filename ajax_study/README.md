<!--
 * @Descripttion:
 * @version:
 * @Author: yang_ft
 * @Date: 2019-12-12 09:27:43
 * @github: famensaodiseng
 * @LastEditTime: 2019-12-12 10:10:13
 -->

使用 jsonp 解决跨域,绕过浏览器的同源策略。他不是 ajax，但是它可以模拟 ajax。script 的 src 就不受同源策略的影响。

#### 解决跨域都有哪些方式

CORS 跨域资源共享策略（

JSONP

window.name

document.domain(主域相同的情况下可用）

postMessage(h5 新引入）

websocket(h5 新引入，不受同源策略限制，所以说 h5 真是个好东西

#### JS 跨域方案 JSONP 与 CORS 的各自优缺点以及应用场景？

首先明确：JSONP 与 CORS 的使用目的相同，并且都需要服务端和客户端同时支持，虽然功能上讲 CORS 更为强大，但是需要根据应用场景选择使用哪一个。JSONP（json with padding 填充式 json），利用了使用 src 引用静态资源时不受跨域限制的机制。主要在客户端搞一个回调做一些数据接收与操作的处理，并把这个回调函数名告知服务端，而服务端需要做的是按照 javascript 的语法把数据放到约定好的回调函数之中即可。jQuery 很早之前就已经把 JSONP 语法糖化了，使用起来会更加方便。CORS（Cross-origin resource sharing 跨域资源共享），依附于 AJAX，通过添加 HTTP Hearder 部分字段请求与获取有权限访问的资源。CORS 对开发者是透明的，因为浏览器会自动根据请求的情况（简单和复杂）做出不同的处理。CORS 的关键是服务端的配置支持。由于 CORS 是 W3C 中一项较“新”的方案，以至于各大网页解析引擎还没有对其进行严格规格的实现，所以不同引擎下可能会有一些不一致。

两者优点与缺点大致互补，放在一块介绍：

1.  JSONP 的主要优势在于对浏览器的支持较好；虽然目前主流浏览器支持 CORS，但 IE10 以下不支持 CORS。
2.  JSONP 只能用于获取资源（即只读，类似于 GET 请求）；CORS 支持所有类型的 HTTP 请求，功能完善。（这点 JSONP 被完虐，但大部分情况下 GET 已经能满足需求了）
3.  JSONP 的错误处理机制并不完善，我们没办法进行错误处理；而 CORS 可以通过 onerror 事件监听错误，并且浏览器控制台会看到报错信息，利于排查。
4.  JSONP 只会发一次请求；而对于复杂请求，CORS 会发两次请求。
5.  始终觉得安全性这个东西是相对的，没有绝对的安全，也做不到绝对的安全。毕竟 JSONP 并不是跨域规范，它存在很明显的安全问题：callback 参数注入和资源访问授权设置。CORS 好歹也算是个跨域规范，在资源访问授权方面进行了限制（Access-Control-Allow-Origin），而且标准浏览器都做了安全限制，比如拒绝手动设置 origin 字段，相对来说是安全了一点。但是回过头来看一下，就算是不安全的 JSONP，我们依然可以在服务端端进行一些权限的限制，服务端和客户端也都依然可以做一些注入的安全处理，哪怕被攻克，它也只能读一些东西。就算是比较安全的 CORS，同样可以在服务端设置出现漏洞或者不在浏览器的跨域限制环境下进行攻击，而且它不仅可以读，还可以写。

应用场景：

如果你需要兼容 IE 低版本浏览器，无疑，JSONP。

如果你需要对服务端资源进行谢操作，无疑，CORS。

其他情况的话，根据自己的对需求的分析和对两者的理解来吧。
